# 📧 이메일 관리자 - Windows 설치 및 실행 가이드

## 🎉 **v1.1 업데이트!** 

### ✅ **새로운 기능들**
- **설치 창 유지**: 설치 완료 후 창이 자동으로 닫히지 않음
- **포괄적 설치 검증**: `설치검증.bat` 파일로 시스템 상태 완전 점검
- **브라우저 자동 열기**: 프로그램 시작 시 자동으로 웹 브라우저 열림
- **강화된 오류 처리**: 연결 문제 시 명확한 해결 방법 제시
- **실시간 서버 상태**: 백엔드/프론트엔드 연결 상태 실시간 모니터링

## 🚀 원클릭 통합 설치 (가장 쉬운 방법)

### 📥 단 하나의 파일로 모든 것을 자동 설치!

1. **필수 프로그램 설치** (먼저 해야 함):
   - **Python 3.7+**: https://www.python.org/downloads/
     - ⚠️ 설치 시 "Add Python to PATH" 반드시 체크!
   - **Node.js 14+**: https://nodejs.org/ (LTS 버전 권장)

2. **통합 자동 설치**:
   ```batch
   INSTALL.bat  # 더블클릭만 하면 끝!
   ```
   
   **설치 모드 선택:**
   - `[1] 🚀 빠른 설치` - 자동으로 모든 과정 진행 (권장)
   - `[2] 🔧 고급 설치` - 단계별 확인하며 설치
   - `[3] 🔍 시스템 상태 확인` - 현재 설치 상태만 확인
   
   **자동 처리 기능:**
   - 🔐 자동으로 관리자 권한 요청
   - 📦 모든 의존성 자동 설치
   - 🔗 바탕화면 바로가기 생성
   - ⚡ 설치 완료 후 바로 실행 가능

3. **프로그램 실행**:
   ```batch
   # 방법 1: 바탕화면 바로가기 더블클릭
   📧 이메일 관리자

   # 방법 2: 실행 파일 더블클릭
   이메일관리자_실행.bat
   ```

4. **브라우저 접속**: http://localhost:3000

## 📁 배치 파일 설명

### 🔧 INSTALL.bat (통합 설치 파일) - **개선됨!**
- **기능**: 모든 설치 과정을 하나의 파일로 통합
- **설치 모드**:
  - `빠른 설치`: 자동으로 모든 과정 진행
  - `고급 설치`: 단계별 확인하며 설치
  - `상태 확인`: 현재 시스템 상태만 확인
- **자동 수행 작업**:
  - 관리자 권한 자동 요청
  - Python/Node.js 설치 확인
  - Python 가상환경 생성
  - 모든 의존성 설치
  - 설정 파일 생성
  - 실행 스크립트 생성
  - 바탕화면 바로가기 생성

### 🔍 설치검증.bat - **신규!**
- **기능**: 포괄적인 설치 상태 검증
- **검증 항목**:
  - 시스템 요구사항 (Python, Node.js)
  - 프로젝트 환경 (가상환경, 패키지)
  - 데이터베이스 연결 테스트
  - 포트 사용 가능성 확인
  - 설정 파일 유효성 검사
  - 빠른 서버 시작 테스트

### ▶️ 이메일관리자_실행.bat - **개선됨!**
- **기능**: 백엔드/프론트엔드 서버 시작
- **새로운 기능**:
  - 단계별 진행 표시 (1/4, 2/4, 3/4, 4/4)
  - 브라우저 자동 열기 (10초 후)
  - 명확한 포트 정보 표시
- **실행 결과**: 
  - 백엔드: http://localhost:5000
  - 프론트엔드: http://localhost:3000

### ⏹️ 이메일관리자_종료.bat
- **기능**: 모든 서버 프로세스 종료
- **사용 시기**: 서버 종료가 필요할 때

### 🔍 이메일관리자_상태확인.bat
- **기능**: 설치/실행 상태 확인
- **확인 항목**:
  - Python/Node.js 설치 상태
  - 가상환경 및 의존성 상태
  - 서버 실행 상태

## 🛠️ 문제 해결

### 설치 오류

#### "관리자 권한이 필요합니다"
```batch
# 해결 방법:
# install.bat 우클릭 → "관리자 권한으로 실행"
```

#### "Python이 설치되지 않았습니다"
```batch
# 해결 방법:
1. https://www.python.org/downloads/ 에서 Python 다운로드
2. 설치 시 "Add Python to PATH" 반드시 체크
3. 설치 후 cmd에서 "python --version" 확인
```

#### "Node.js가 설치되지 않았습니다"
```batch
# 해결 방법:
1. https://nodejs.org/ 에서 Node.js LTS 버전 다운로드
2. 설치 후 cmd에서 "node --version" 확인
```

#### "npm install 실패"
```batch
# 해결 방법:
cd frontend
npm cache clean --force
npm install --legacy-peer-deps
```

### 실행 오류

#### "가상환경이 없습니다"
```batch
# 해결 방법:
install.bat  # 다시 실행
```

#### "포트가 이미 사용 중입니다"
```batch
# 해결 방법:
stop_server.bat  # 기존 서버 종료 후
run_server.bat   # 다시 실행
```

#### "브라우저에서 접속되지 않습니다"
```batch
# 확인 사항:
1. check_status.bat으로 서버 상태 확인
2. 방화벽 설정 확인
3. 다른 프로그램의 포트 사용 여부 확인
```

## 📋 수동 설치 (고급 사용자)

### Python 환경 설정
```batch
# 가상환경 생성
python -m venv venv

# 가상환경 활성화
venv\Scripts\activate.bat

# 의존성 설치
cd backend
pip install -r requirements.txt
```

### Node.js 환경 설정
```batch
cd frontend
npm install --legacy-peer-deps
```

### 수동 실행
```batch
# 터미널 1 - 백엔드
venv\Scripts\activate.bat
cd backend
python app.py

# 터미널 2 - 프론트엔드
cd frontend
npm start
```

## 🎯 사용 방법

### 1. 초기 설정
1. 브라우저에서 http://localhost:3000 접속
2. 상단 "설정" 클릭
3. "이메일 루트 폴더 경로"에 .eml 파일 폴더 경로 입력
   ```
   예시: C:\Users\사용자명\Documents\Emails
   ```
4. "설정 저장" 클릭

### 2. 이메일 관리
- **폴더 탐색**: 왼쪽 사이드바
- **이메일 목록**: 중간 패널
- **이메일 내용**: 오른쪽 패널
- **검색**: 상단 검색바

### 3. 테스트
- `test_emails` 폴더에 .eml 파일 복사
- 설정에서 해당 폴더 경로 지정
- 이메일 목록 확인

## 📝 파일 구조
```
eml_Mater_v1/
├── install.bat          # 설치 스크립트
├── run_server.bat       # 실행 스크립트
├── stop_server.bat      # 종료 스크립트
├── check_status.bat     # 상태 확인
├── venv/               # Python 가상환경
├── backend/            # Flask 백엔드
├── frontend/           # React 프론트엔드
├── test_emails/        # 테스트용 폴더
└── install_log.txt     # 설치 로그
```

## 🔒 보안 고려사항
- 프로그램은 localhost에서만 실행됩니다
- 외부 네트워크 접근이 차단됩니다
- 모든 데이터는 로컬에서만 처리됩니다

## 💡 팁
- 바탕화면의 "이메일 관리자" 바로가기 활용
- `check_status.bat`으로 주기적 상태 확인
- 문제 발생 시 `install_log.txt` 확인